{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="{% static 'css/editProfile.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <!-- Navbar with logo and title in the center -->
  <div class="navbar">
    <span class="toggle-btn" onclick="toggleSidebar()"><i class="fa fa-bars"></i></span>
    <div class="logo">
      <img src="{% static "img/logo.jpg" %}" alt="Logo">
      <span class="logo-text">AQUA FLOW</span>
    </div>
  </div>

  <!-- Sidebar with navigation links -->
  <div class="sidebar" id="sidebar">
    <a href="/profile/{{request.session.userid}}">PROFILE</a>
    <a href="/feedback">FEEDBACK</a>
    <a href="/complaint">COMPLAINTS</a>
    <a href="/chat">CHAT</a>
    <a href="/logout">LOGOUT</a>
  </div>
  <main id="main-content">
    <form class="card" method='post' enctype='multipart/form-data'>
        {% csrf_token %}
        <h1>PROFILE</h1>
    <table>
        
            <table>
                <tr>
                    <td>
                        <div class="upload-container">
                        {% comment %} <label for="file-input" class="upload-label"> {% endcomment %}
                            {% if val.Profile %}
                            <img src="{{val.Profile.url}}">
                            {% else %}
                            <i class="upload-icon"><img src={% static "profile.png"%}></i> 
                            {% endif %}<!-- Unicode camera icon -->
                        </label>
                        <input type="file" id="file-input" accept="image/*" name="Profile"/>
                    </div>
                </td>
                    <td class="td">{{val.First_name}} {{val.Mid_name}} {{val.Last_name}}<br>
                        
                    </td>
                    </td>
                </tr>
    </table>
    <div class="ph">
    <div><p>{{val.Phone_no}}</p><div>
        <div><p>{{val.Mail}}</p></div>
        <div><p>{{val.Pincode}}</p></div>
        <div><p>{{val.Address}}</p> </div>
    <div><p>{{val.Panchayath_name}}</p></div>
    <div><p>{{val.id}}</p></div>
    </div>
    <div class="btn"><a href="/edit_profile/{{request.session.userid}}" ><button type="button">EDIT</button></a> </div>
 
</form>
</main>
<script>
    let isOpen = false;

    function toggleSidebar() {
      if (isOpen) {
        closeSidebar();
      } else {
        openSidebar();
      }
    }

    function openSidebar() {
      document.getElementById("sidebar").style.width = "250px"; /* Open sidebar */
      document.getElementById("main-content").classList.add('sidebar-open'); /* Adjust main content */
      document.querySelector('.toggle-btn i').classList.remove('fa-bars'); /* Change to close icon */
      document.querySelector('.toggle-btn i').classList.add('fa-times');
      isOpen = true;

      // Add event listener for clicks outside the sidebar
      document.addEventListener('click', handleOutsideClick);
    }

    function closeSidebar() {
      document.getElementById("sidebar").style.width = "0"; /* Close sidebar */
      document.getElementById("main-content").classList.remove('sidebar-open'); /* Reset main content */
      document.querySelector('.toggle-btn i').classList.remove('fa-times'); /* Change back to menu icon */
      document.querySelector('.toggle-btn i').classList.add('fa-bars');
      isOpen = false;

      // Remove event listener for outside clicks
      document.removeEventListener('click', handleOutsideClick);
    }

    // Function to detect clicks outside the sidebar and close it
    function handleOutsideClick(event) {
      const sidebar = document.getElementById('sidebar');
      if (isOpen && !sidebar.contains(event.target) && !event.target.closest('.toggle-btn')) {
        closeSidebar();
      }
    }
  </script>
</body>
</html>